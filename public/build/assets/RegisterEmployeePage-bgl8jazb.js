import{_ as N,L as F,r as d,p as q,c as s,a,w as b,v as x,b as g,t as f,e as w,d as P,o as t,f as C,g as L,B as U,F as S,i as E,m as M,M as T,u as V,N as B}from"./main-6TRAM3lj.js";import{L as A}from"./LoginLeftPanel-_vXK8big.js";import{a as j}from"./authService-ZaU-JPLS.js";const J={name:"RegisterFormEmployee",props:{loading:{type:Boolean,default:!1},error:{type:[String,Object],default:null},formId:{type:String,required:!0}},emits:["submit","login"],setup(p,{emit:o}){const r=F({fullname:"",email:"",tel_number:"+60 ",password:"",password_confirmation:""}),e=d("");q(e,l=>{r.tel_number=`+60${l}`});const i=d(null),c=d(""),n=d("");return{formData:r,phoneNumber:e,imageFile:i,imageFileName:c,imagePreview:n,handleFileUpload:l=>{const u=l.target.files[0];if(u){i.value=u,c.value=u.name;const D=new FileReader;D.onload=v=>{n.value=v.target.result},D.readAsDataURL(u)}},handleSubmit:()=>{const l=new FormData;Object.keys(r).forEach(u=>{l.append(u,r[u])}),i.value&&l.append("image",i.value),o("submit",l)}}}},O={class:"form-group"},Y={class:"form-group"},H={class:"form-group"},z={class:"form-group"},G={class:"phone-input-container"},K={class:"form-group"},Q={class:"form-group"},W={class:"form-group file-upload"},X={for:"employee_image",class:"file-label"},Z={key:0,class:"logo-preview"},$=["src"],ee=["disabled"],oe={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},ae={class:"text-center mt-3"};function ne(p,o,r,e,i,c){return t(),s("form",{onSubmit:o[7]||(o[7]=P((...n)=>e.handleSubmit&&e.handleSubmit(...n),["prevent"])),class:"login-form",enctype:"multipart/form-data"},[a("div",O,[b(a("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>e.formData.fullname=n),placeholder:"Full Name",required:""},null,512),[[x,e.formData.fullname]])]),a("div",Y,[b(a("input",{type:"email","onUpdate:modelValue":o[1]||(o[1]=n=>e.formData.email=n),placeholder:"Email",required:""},null,512),[[x,e.formData.email]])]),a("div",H,[a("div",z,[o[9]||(o[9]=a("label",{for:"tel_number"},"Phone Number",-1)),a("div",G,[o[8]||(o[8]=a("div",{class:"phone-prefix"},"+60",-1)),b(a("input",{type:"tel",id:"tel_number","onUpdate:modelValue":o[2]||(o[2]=n=>e.phoneNumber=n),placeholder:"xxxxx xxxx",required:"",class:"phone-input"},null,512),[[x,e.phoneNumber]])]),o[10]||(o[10]=a("small",{class:"form-text text-muted"},"Malaysian format: +60 xxxxx xxxx (enter only the digits after +60)",-1))])]),a("div",K,[b(a("input",{type:"password","onUpdate:modelValue":o[3]||(o[3]=n=>e.formData.password=n),placeholder:"Password",required:""},null,512),[[x,e.formData.password]])]),a("div",Q,[b(a("input",{type:"password","onUpdate:modelValue":o[4]||(o[4]=n=>e.formData.password_confirmation=n),placeholder:"Confirm Password",required:""},null,512),[[x,e.formData.password_confirmation]])]),a("div",W,[a("label",X,[a("span",null,f(e.imageFileName||"Upload Profile Picture (Optional)"),1),a("input",{type:"file",id:"employee_image",onChange:o[5]||(o[5]=(...n)=>e.handleFileUpload&&e.handleFileUpload(...n)),accept:"image/*",class:"file-input"},null,32)]),e.imagePreview?(t(),s("div",Z,[a("img",{src:e.imagePreview,alt:"Profile Picture Preview"},null,8,$)])):g("",!0)]),a("button",{type:"submit",class:"btn btn-primary w-100",disabled:r.loading},[r.loading?(t(),s("span",oe)):g("",!0),w(" "+f(r.loading?"Registering...":"Register"),1)],8,ee),a("div",ae,[o[11]||(o[11]=w(" Already have an account? ")),a("a",{href:"#",onClick:o[6]||(o[6]=P(n=>p.$emit("login"),["prevent"]))},"Login")])],32)}const re=N(J,[["render",ne],["__scopeId","data-v-4fb662e0"]]),te={name:"RegisterEmployeePage",components:{LoginLeftPanel:A,RegisterFormEmployee:re},setup(){const p=V(),o=T(),r=d(!1),e=d(null),i=d(null),c=d(""),n=d(""),h=d(""),y=["Join your company team","Connect with your colleagues","Access company resources","Be part of the Halal ecosystem"],l=async v=>{try{r.value=!0;const m=await B.get(`/api/companies/form/${v}`);m.data&&(n.value=m.data.company_name,m.data.company_image&&(h.value=m.data.company_image)),r.value=!1}catch(m){console.error("Error fetching company info:",m),m.value="Could not retrieve company information. Please check the registration link.",r.value=!1}};return M(()=>{o.query.formID?(console.log("FormID found:",o.query.formID),c.value=o.query.formID,l(c.value)):(console.error("No formID in query params"),e.value="Company ID is required. Please contact your administrator.",setTimeout(()=>{p.push({name:"Login"})},3e3))}),{loading:r,error:e,successMessage:i,animatedTexts:y,formID:c,companyName:n,companyImage:h,handleRegister:async v=>{var m,R,k,I;r.value=!0,e.value=null,i.value=null;try{v.append("formID",c.value);const _=await j(v);i.value=_.message||"Registration successful! Your account is pending approval. Redirecting to login page...",setTimeout(()=>{p.push({name:"Login"})},3e3)}catch(_){console.error("Registration error:",_),(R=(m=_.response)==null?void 0:m.data)!=null&&R.errors?e.value=_.response.data.errors:e.value=((I=(k=_.response)==null?void 0:k.data)==null?void 0:I.message)||"Registration failed. Please try again."}finally{r.value=!1}},goToLogin:()=>{p.push({name:"Login"})}}}},se={class:"login-container"},le={class:"login-card"},ie={class:"right-panel"},me={key:0,class:"company-info mb-4"},de={key:0,class:"company-image mb-3"},ce=["src"],ue={key:1},pe={key:2,class:"alert alert-success w-100 mb-4"},ge={key:3,class:"alert alert-danger w-100 mb-4"},fe={key:0},ye={key:1,class:"mb-0 ps-3"};function ve(p,o,r,e,i,c){const n=L("login-left-panel"),h=L("register-form-employee");return t(),s("div",se,[a("div",le,[C(n,{texts:e.animatedTexts},null,8,["texts"]),a("div",ie,[e.companyName?(t(),s("div",me,[e.companyImage?(t(),s("div",de,[a("img",{src:e.companyImage,alt:"Company Logo",class:"img-fluid rounded",style:{"max-height":"80px"}},null,8,ce)])):g("",!0),a("h2",null,"Join "+f(e.companyName),1),o[0]||(o[0]=a("p",null,"Register as an employee",-1))])):(t(),s("div",ue,o[1]||(o[1]=[a("h2",null,"Join Your Company",-1),a("p",null,"Register as an employee",-1)]))),e.successMessage?(t(),s("div",pe,[o[2]||(o[2]=a("i",{class:"fas fa-check-circle me-2"},null,-1)),w(" "+f(e.successMessage),1)])):g("",!0),e.error?(t(),s("div",ge,[o[3]||(o[3]=a("div",{class:"text-center"},[a("i",{class:"fas fa-exclamation-circle me-2"})],-1)),o[4]||(o[4]=w()),typeof e.error=="string"?(t(),s("span",fe,f(e.error),1)):typeof e.error=="object"?(t(),s("ul",ye,[(t(!0),s(S,null,E(e.error,(y,l)=>(t(),s("li",{key:l},[a("strong",null,f(l)+":",1),w(" "+f(Array.isArray(y)?y.join(", "):y),1)]))),128))])):g("",!0)])):g("",!0),e.successMessage?g("",!0):(t(),U(h,{key:4,loading:e.loading,error:null,formId:e.formID,onSubmit:e.handleRegister,onLogin:e.goToLogin},null,8,["loading","formId","onSubmit","onLogin"]))])])])}const xe=N(te,[["render",ve],["__scopeId","data-v-e465f68a"]]);export{xe as default};
