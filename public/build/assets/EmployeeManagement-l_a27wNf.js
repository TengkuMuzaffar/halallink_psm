import{_ as T,c as v,a as e,f as S,g as P,o as f,b as M,t as r,C as p,D as Y,i as V,E as D,G as Z,H as ee,I as te,j as ae,e as b,B as se,d as C,F as oe,r as g,A as F,m as I,z as L,h as ne,w as le,J as ie}from"./main-6TRAM3lj.js";import{S as re}from"./StatsCard-CQZ5Yey2.js";import{R as N}from"./ResponsiveTable-Dmb47gmH.js";import{m as k}from"./modal-CNQBRbiU.js";import"./LoadingSpinner-Bs7tkB0U.js";const de={name:"EmployeeStats",components:{StatsCard:re},props:{stats:{type:Object,default:()=>({total:0,active:0,inactive:0})}}},ce={class:"employee-stats"},me={class:"row"},ue={class:"col-md-4 col-sm-6 mb-3 mb-md-0"},pe={class:"col-md-4 col-sm-6 mb-3 mb-md-0"},ye={class:"col-md-4 col-sm-12"};function ge(l,t,i,a,_,w){const y=P("StatsCard");return f(),v("div",ce,[e("div",me,[e("div",ue,[S(y,{title:"Total Employees",count:i.stats.total||0,icon:"fas fa-users","bg-color":"bg-primary"},null,8,["count"])]),e("div",pe,[S(y,{title:"Active Employees",count:i.stats.active||0,icon:"fas fa-user-check","bg-color":"bg-success"},null,8,["count"])]),e("div",ye,[S(y,{title:"Inactive Employees",count:i.stats.inactive||0,icon:"fas fa-user-times","bg-color":"bg-danger"},null,8,["count"])])])])}const fe=T(de,[["render",ge]]),ve={name:"EmployeeTable",components:{ResponsiveTable:N},props:{title:{type:String,default:"Employees"},employees:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},columns:{type:Array,required:!0},showAddButton:{type:Boolean,default:!0}},emits:["add","sort","page-change","search"]},be={class:"employee-table"},he={class:"card"},_e={class:"card-header d-flex justify-content-between align-items-center"},we={class:"mb-0"},ke=["disabled"],Ee={class:"ms-1 d-none d-md-inline"},Ce={class:"card-body"};function Se(l,t,i,a,_,w){const y=P("ResponsiveTable");return f(),v("div",be,[e("div",he,[e("div",_e,[e("h5",we,r(i.title),1),i.showAddButton?(f(),v("button",{key:0,class:"btn btn-primary",onClick:t[0]||(t[0]=d=>l.$emit("add")),disabled:i.loading},[e("i",{class:p(["fas",i.loading?"fa-spinner fa-spin":"fa-copy"])},null,2),e("span",Ee,r(i.loading?"Loading...":"Copy Registration Link"),1)],8,ke)):M("",!0)]),e("div",Ce,[S(y,{columns:i.columns,items:i.employees,loading:i.loading,"has-actions":!0,"item-key":"userID",onSort:t[1]||(t[1]=d=>l.$emit("sort",d)),onPageChange:t[2]||(t[2]=d=>l.$emit("page-change",d)),onSearch:t[3]||(t[3]=d=>l.$emit("search",d))},Y({_:2},[V(l.$slots,(d,E)=>({name:E,fn:D(s=>[Z(l.$slots,E,ee(te(s)))])}))]),1032,["columns","items","loading"])])])])}const De=T(ve,[["render",Se]]),Pe=ae({name:"EmployeeCard",props:{employee:{type:Object,required:!0}},methods:{formatDate(l){return l?new Date(l).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):""},getStatusBadgeClass(l,t=!1){if(t)return{"status-active":l==="active","status-inactive":l==="inactive"||l==="pending","status-default":!l};const i="badge ";switch(l){case"active":return i+"bg-success";case"inactive":return i+"bg-danger";default:return i+"bg-secondary"}}}}),$e={class:"employee-card-modal"},Le={class:"modal fade",id:"employeeCardModal",tabindex:"-1","aria-labelledby":"employeeCardModalLabel","aria-hidden":"true"},Me={class:"modal-dialog modal-dialog-centered"},Te={class:"modal-content p-0 m-0 border-0"},xe={class:"modal-body p-0"},Be={class:"employee-id-card"},Ie={class:"card-header text-center py-3"},Ae={class:"mb-0 fw-bold"},Re={class:"card-body p-2"},Fe={class:"employee-avatar text-center mb-4"},Ve={class:"avatar-container"},Ne={class:"mt-3 mb-0 fw-bold"},je={class:"employee-id-badge mt-1"},He={class:"employee-details"},ze={class:"detail-row"},Je={class:"detail-value"},qe={class:"detail-row"},Oe={class:"detail-value"},Ue={class:"detail-row"},We={class:"detail-value"},Ge={class:"detail-row"},Qe={class:"detail-value"};function Ke(l,t,i,a,_,w){return f(),v("div",$e,[e("div",Le,[e("div",Me,[e("div",Te,[t[6]||(t[6]=e("div",{class:"d-flex justify-content-end p-2",style:{"background-color":"#123524","border-bottom":"0 !important"}},[e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),e("div",xe,[e("div",Be,[e("div",Ie,[t[0]||(t[0]=e("div",{class:"company-logo mb-2"},[e("img",{src:"/images/HalalLink.png",alt:"Company Logo",class:"img-fluid",style:{"max-height":"60px"}})],-1)),e("h4",Ae,r(l.employee.company_name||"HalalLink"),1)]),e("div",Re,[e("div",Fe,[e("div",Ve,[t[1]||(t[1]=e("div",{class:"avatar-placeholder"},[e("i",{class:"fas fa-user fa-3x"})],-1)),e("div",{class:p(["avatar-badge",l.getStatusBadgeClass(l.employee.status,!0)])},[e("i",{class:p(["fas",l.employee.status==="active"?"fa-check":"fa-times"])},null,2)],2)]),e("h5",Ne,r(l.employee.fullname),1),e("div",je,"ID: "+r(l.employee.userID),1)]),e("div",He,[e("div",ze,[t[2]||(t[2]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-envelope me-2"}),b("Email:")],-1)),e("div",Je,r(l.employee.email),1)]),e("div",qe,[t[3]||(t[3]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-phone me-2"}),b("Phone:")],-1)),e("div",Oe,r(l.employee.tel_number||"Not provided"),1)]),e("div",Ue,[t[4]||(t[4]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-calendar me-2"}),b("Joined:")],-1)),e("div",We,r(l.formatDate(l.employee.created_at)),1)]),e("div",Ge,[t[5]||(t[5]=e("div",{class:"detail-label"},[e("i",{class:"fas fa-check-circle me-2"}),b("Status:")],-1)),e("div",Qe,[e("span",{class:p(l.getStatusBadgeClass(l.employee.status))},r(l.employee.status),3)])])])])])]),t[7]||(t[7]=e("div",{class:"modal-footer border-0"},[e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])])])}const Xe=T(Pe,[["render",Ke],["__scopeId","data-v-91f3fb33"]]),Ye={name:"EmployeeManagement",components:{EmployeeStats:fe,EmployeeTable:De,ResponsiveTable:N,EmployeeCard:Xe},setup(){const l=ne(),t=g(!0),i=g(null),a=g([]),_=g(""),w=g(""),y=g(null),d=g(1),E=g(5),s=g({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),h=F(()=>{const o=[],c=s.value.last_page;if(c<=5)for(let m=1;m<=c;m++)o.push(m);else{let m=Math.max(1,s.value.current_page-Math.floor(2.5)),x=Math.min(c,m+5-1);x===c&&(m=Math.max(1,x-5+1));for(let B=m;B<=x;B++)o.push(B)}return o}),A=g({total:0,active:0,inactive:0}),R=[{key:"fullname",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"tel_number",label:"Phone",sortable:!1},{key:"status",label:"Status",sortable:!1},{key:"created_at",label:"Joined",sortable:!0}],j=F(()=>typeof window>"u"?R:window.innerWidth<768?[{key:"fullname",label:"Name",sortable:!0},{key:"status",label:"Status",sortable:!1}]:window.innerWidth<992?[{key:"fullname",label:"Name",sortable:!0},{key:"status",label:"Status",sortable:!1},{key:"created_at",label:"Joined",sortable:!0}]:R),H=()=>{a.value=[...a.value]};I(()=>{window.addEventListener("resize",H)});const u=async()=>{try{t.value=!0,i.value=null;const o={page:d.value,per_page:E.value,search:w.value||null,status:_.value||null},n=await L.get("/api/employees",{params:o});n.data&&n.success?(a.value=n.data,s.value=n.pagination,$()):(a.value=[],console.error("Unexpected response format:",n))}catch(o){console.error("Error fetching employees:",o),i.value=o.message||"Failed to load employees. Please try again later.",a.value=[]}finally{t.value=!1}},$=async()=>{try{const o={search:w.value||null,status:_.value||null},n=await L.get("/api/employees/all/stats",{params:o});n&&(A.value=n)}catch(o){console.error("Error fetching employee stats:",o)}},z=()=>{d.value=1,u(),$()},J=o=>{w.value=o,d.value=1,u(),$()},q=o=>{o<1||o>s.value.last_page||t.value||(d.value=o,u())};I(()=>{u(),$()});const O=o=>o?new Date(o).toLocaleDateString():"",U=o=>{const n="badge ";switch(o){case"active":return n+"bg-success";case"inactive":return n+"bg-danger";default:return n+"bg-secondary"}},W=()=>{const o=`${window.location.origin}/register-employee?formID=${l.state.user.company.formID}`;k.show({type:"info",title:"Add New Employee",message:`
            <p>Share this registration link with your new employee:</p>
            <div class="input-group mb-3">
              <input type="text" class="form-control" value="${o}" id="registration-link" readonly>
              <button class="btn btn-outline-secondary" type="button" id="copy-link-btn">
                <i class="fas fa-copy"></i> Copy
              </button>
            </div>
          `,onShown:()=>{const n=document.getElementById("copy-link-btn"),c=document.getElementById("registration-link");n&&c&&n.addEventListener("click",()=>{c.select(),document.execCommand("copy");const m=n.innerHTML;n.innerHTML='<i class="fas fa-check"></i> Copied!',n.classList.replace("btn-outline-secondary","btn-success"),setTimeout(()=>{n.innerHTML=m,n.classList.replace("btn-success","btn-outline-secondary")},2e3)})}})},G=async o=>{const n=o.status==="active"?"inactive":"active",c=n==="active"?"activate":"deactivate";k.confirm(`${n==="active"?"Activate":"Deactivate"} Employee`,`Are you sure you want to ${c} ${o.name}?`,async()=>{t.value=!0;try{await L.fetchData(`/api/employees/${o.userID}/status`,{method:"patch",data:{status:n},onSuccess:m=>{u(),k.success("Success",`Employee ${c}d successfully`)},onError:m=>{console.error(`Error ${c}ing employee:`,m),k.danger("Error",`Failed to ${c} employee. Please try again.`),u()}})}catch{u()}},null,{confirmLabel:n==="active"?"Activate":"Deactivate",confirmType:n==="active"?"success":"warning"})},Q=o=>{},K=o=>{y.value=o,setTimeout(()=>{const n=document.getElementById("employeeCardModal");n&&new bootstrap.Modal(n).show()},100)},X=async o=>{k.confirm("Delete Employee",`Are you sure you want to delete ${o.name}?`,async()=>{t.value=!0;try{await L.fetchData(`/api/employees/${o.userID}`,{method:"delete",onSuccess:n=>{k.success("Success","Employee deleted successfully"),u()},onError:n=>{console.error("Error deleting employee:",n),k.danger("Error","Failed to delete employee. Please try again."),u()}})}catch{u()}},null,{confirmLabel:"Delete",confirmType:"danger"})};return I(()=>{u()}),{loading:t,error:i,employees:a,employeeStats:A,displayColumns:j,statusFilter:_,pagination:s,paginationRange:h,currentPage:d,selectedEmployee:y,formatDate:O,getStatusBadgeClass:U,copyRegistrationLink:W,viewEmployee:K,editEmployee:Q,deleteEmployee:X,toggleEmployeeStatus:G,applyFilters:z,handleSearch:J,changePage:q}}},Ze={class:"employee-management"},et={class:"card"},tt={class:"card-header theme-header d-flex justify-content-between align-items-center"},at={class:"card-body"},st={key:0,class:"alert alert-danger",role:"alert"},ot={class:"d-flex gap-2"},nt={class:"action-buttons d-none d-md-flex"},lt=["onClick"],it=["onClick"],rt=["onClick"],dt={class:"dropdown d-md-none"},ct={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"actionDropdown"},mt=["onClick"],ut=["onClick"],pt=["onClick"],yt={key:1,class:"d-flex justify-content-between align-items-center mt-3"},gt={class:"text-muted"},ft={"aria-label":"Table pagination"},vt={class:"pagination mb-0"},bt=["onClick"];function ht(l,t,i,a,_,w){const y=P("EmployeeStats"),d=P("ResponsiveTable"),E=P("EmployeeCard");return f(),v("div",Ze,[t[15]||(t[15]=e("h1",{class:"mb-4"},"Employee Management",-1)),S(y,{stats:a.employeeStats,class:"mb-4"},null,8,["stats"]),e("div",et,[e("div",tt,[t[6]||(t[6]=e("h5",{class:"mb-0"},"Employees",-1)),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...s)=>a.copyRegistrationLink&&a.copyRegistrationLink(...s))},t[5]||(t[5]=[e("i",{class:"fas fa-plus me-1"},null,-1),b(" Add Employee ")]))]),e("div",at,[a.error?(f(),v("div",st,r(a.error),1)):M("",!0),S(d,{columns:a.displayColumns,items:a.employees,loading:a.loading,"has-actions":!0,"item-key":"userID",onSearch:a.handleSearch,"show-pagination":!1,"server-side":!0},{filters:D(()=>[e("div",ot,[le(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[1]||(t[1]=s=>a.statusFilter=s),onChange:t[2]||(t[2]=(...s)=>a.applyFilters&&a.applyFilters(...s))},t[7]||(t[7]=[e("option",{value:""},"All Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),544),[[ie,a.statusFilter]])])]),status:D(({item:s})=>[e("span",{class:p(a.getStatusBadgeClass(s.status))},r(s.status),3)]),created_at:D(({item:s})=>[b(r(a.formatDate(s.created_at)),1)]),actions:D(({item:s})=>[e("div",nt,[e("button",{class:p(["btn btn-sm me-1",s.status==="active"?"btn-outline-warning":"btn-outline-success"]),onClick:h=>a.toggleEmployeeStatus(s)},[e("i",{class:p(s.status==="active"?"fas fa-ban":"fas fa-check")},null,2)],10,lt),e("button",{class:"btn btn-sm btn-outline-info me-1",onClick:h=>a.viewEmployee(s)},t[8]||(t[8]=[e("i",{class:"fas fa-eye"},null,-1)]),8,it),e("button",{class:"btn btn-sm btn-outline-danger",onClick:h=>a.deleteEmployee(s)},t[9]||(t[9]=[e("i",{class:"fas fa-trash"},null,-1)]),8,rt)]),e("div",dt,[t[12]||(t[12]=e("button",{class:"btn btn-sm btn-outline-secondary dropdown-toggle",type:"button",id:"actionDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fas fa-ellipsis-v"})],-1)),e("ul",ct,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:C(h=>a.toggleEmployeeStatus(s),["prevent"])},[e("i",{class:p([s.status==="active"?"fas fa-ban text-warning":"fas fa-check text-success","me-2"])},null,2),b(" "+r(s.status==="active"?"Deactivate":"Activate"),1)],8,mt)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:C(h=>a.viewEmployee(s),["prevent"])},t[10]||(t[10]=[e("i",{class:"fas fa-eye text-info me-2"},null,-1),b(" View ")]),8,ut)]),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:C(h=>a.deleteEmployee(s),["prevent"])},t[11]||(t[11]=[e("i",{class:"fas fa-trash text-danger me-2"},null,-1),b(" Delete ")]),8,pt)])])])]),_:1},8,["columns","items","loading","onSearch"]),a.pagination.last_page>0?(f(),v("div",yt,[e("div",null,[e("span",gt,"Showing "+r(a.pagination.from||0)+" to "+r(a.pagination.to||0)+" of "+r(a.pagination.total||0)+" entries",1)]),e("nav",ft,[e("ul",vt,[e("li",{class:p(["page-item",{disabled:a.currentPage===1||a.loading}])},[e("a",{class:"page-link",href:"#",onClick:t[3]||(t[3]=C(s=>!a.loading&&a.changePage(a.currentPage-1),["prevent"]))},t[13]||(t[13]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))],2),(f(!0),v(oe,null,V(a.paginationRange,s=>(f(),v("li",{key:s,class:p(["page-item",{active:s===a.currentPage,disabled:a.loading}])},[e("a",{class:"page-link",href:"#",onClick:C(h=>!a.loading&&a.changePage(s),["prevent"])},r(s),9,bt)],2))),128)),e("li",{class:p(["page-item",{disabled:a.currentPage===a.pagination.last_page||a.loading}])},[e("a",{class:"page-link",href:"#",onClick:t[4]||(t[4]=C(s=>!a.loading&&a.changePage(a.currentPage+1),["prevent"]))},t[14]||(t[14]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])])])):M("",!0)])]),a.selectedEmployee?(f(),se(E,{key:0,employee:a.selectedEmployee,onEdit:a.editEmployee},null,8,["employee","onEdit"])):M("",!0)])}const St=T(Ye,[["render",ht],["__scopeId","data-v-5d0468a0"]]);export{St as default};
