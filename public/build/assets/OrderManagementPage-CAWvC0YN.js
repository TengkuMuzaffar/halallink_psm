import{P as w,_ as $,c as i,a as e,t as m,f as k,g as R,d as _e,b as g,e as J,o as d,w as A,v as W,J as ve,F as B,i as z,r as f,L as ye,A as G,h as be,m as Ce,z as Z,C as S}from"./main-6TRAM3lj.js";import{S as we}from"./StatsCard-CQZ5Yey2.js";import{R as ke}from"./ResponsiveTable-Dmb47gmH.js";import{L as ee}from"./LoadingSpinner-Bs7tkB0U.js";import{f as P}from"./formatter-CdZpJCmm.js";import{P as De}from"./Pagination-BlCQa_G8.js";const E={fetchLocationsByCompanyType(a={}){return w("/api/orders/location/company/type",{params:a})},fetchOrdersByLocationID(a,t={}){return w(`/api/orders/location/${a}`,{params:t})},fetchOrders(a={}){return w("/api/orders",{params:a})},fetchOrderStats(){return w("/api/orders/stats")},fetchOrderWithCheckpoints(a){return w(`/api/orders/${a}/checkpoints`)},getOrderById(a){return w(`/api/orders/${a}`)},createOrder(a){return w("/api/orders",{method:"post",data:a})},updateOrder(a,t){return w(`/api/orders/${a}`,{method:"put",data:t})},generateLocationQR(a,t){return w(`/api/qrcode/process/${a}/${t||0}`)}},Ie={name:"OrderDetailModal",components:{LoadingSpinner:ee},props:{modalId:{type:String,default:"orderDetailModal"},orderId:{type:[Number,String],default:null},orderData:{type:Object,default:null},showMainModalAfterQR:{type:Boolean,default:!0}},data(){return{loading:!1,order:null,error:null,qrCodeLoading:!1,qrCodeUrl:null,qrCodeLink:"",qrCodeLink:"",qrCodeTitle:"",qrCodeDescription:"",selectedOrderID:null,selectedLocationID:null,qrModal:null,mainModal:null,copySuccess:!1}},computed:{},watch:{orderId(a){a?this.orderData?(this.order=this.orderData,this.loading=!1):this.fetchOrderDetails(a):(this.order=null,this.error=null)},orderData(a){a&&(this.order=a,this.loading=!1,this.error=null)}},methods:{formatCurrency(a){return P.formatCurrency(a)},formatDateTime(a){return P.formatDate(a)},capitalizeFirstLetter(a){return a?a.charAt(0).toUpperCase()+a.slice(1):""},formatStatus(a){return a?a.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):"Unknown"},async fetchOrderDetails(a){var t,c;this.loading=!0,this.error=null,this.order=null;try{const o=await E.getOrderById(a);this.order=o.data}catch(o){console.error("Error fetching order details:",o),this.error="Failed to load order details. "+(((c=(t=o.response)==null?void 0:t.data)==null?void 0:c.message)||o.message)}finally{this.loading=!1}},getStatusColor(a){return{pending:"warning",processing:"info",shipped:"primary",delivered:"success",completed:"success",complete:"success",cancelled:"danger",waiting_delivery:"primary",paid:"success"}[a==null?void 0:a.toLowerCase()]||"secondary"},showQRCode(a,t,c=null){this.selectedOrderID=null,this.selectedLocationID=t,this.qrCodeLoading=!0,this.qrCodeUrl=null;const o=document.getElementById("qrCodeModal");if(c===null&&this.order&&this.order.locations){const b=this.order.locations.find(L=>L.locationID===t);b&&(c=b.companyID)}const u=Date.now(),y=u+2*60*60*1e3,p=`/api/qrcode/process/${t}/${c||0}?timestamp=${u}&expires=${y}`;this.qrCodeLink=`${window.location.origin}${p}`,this.qrCodeTitle="Location QR Code",this.selectedLocationID=`Location ${t}`,this.qrCodeDescription="Scan this QR code to process items at this location.",this.generateQRCode(this.qrCodeLink),this.qrModal&&(o&&(o.removeAttribute("inert"),o.removeAttribute("aria-hidden")),this.qrModal.show())},generateOrderVerificationQR(a){this.selectedOrderID=a,this.qrCodeLoading=!0,this.qrCodeUrl=null;const t=document.getElementById("qrCodeModal"),c=`/api/qrcode/verifies/${a}`;this.qrCodeLink=`${window.location.origin}${c}`,this.qrCodeTitle="Order Verification QR Code",this.qrCodeDescription="Scan this QR code to check the verification status of this order.",this.generateQRCode(this.qrCodeLink),this.qrModal&&(t&&(t.removeAttribute("inert"),t.removeAttribute("aria-hidden")),this.qrModal.show())},closeQRModal(){const a=document.getElementById("qrCodeModal");this.qrModal&&(a&&(a.setAttribute("inert",""),a.removeAttribute("aria-hidden")),this.qrModal.hide(),document.querySelectorAll(".modal-backdrop").forEach(c=>{c.classList.remove("show"),setTimeout(()=>{c.remove()},150)}))},generateQRCode(a){this.qrCodeLoading=!1;const t=document.createElement("canvas");QRCode.toCanvas(t,a,{width:250,margin:2,color:{dark:"#000000",light:"#ffffff"}},c=>{c?(console.error("Error generating QR code:",c),this.qrCodeUrl=null):(this.qrCodeUrl=t.toDataURL(),this.qrCodeLink="")})}},mounted(){this.orderId&&(this.orderData?this.order=this.orderData:this.fetchOrderDetails(this.orderId)),this.qrModal=new bootstrap.Modal(document.getElementById("qrCodeModal"),{backdrop:!0,keyboard:!0,focus:!0});const a=document.getElementById("qrCodeModal"),t=new MutationObserver(c=>{c.forEach(o=>{if(o.type==="attributes"&&o.attributeName==="aria-hidden"){const u=o.target;u.querySelector('button, a, input, select, textarea, [tabindex]:not([tabindex="-1"])')&&u.removeAttribute("aria-hidden")}})});a&&(t.observe(a,{attributes:!0}),a.addEventListener("hidden.bs.modal",c=>{document.querySelectorAll(".modal-backdrop").forEach(u=>{u.classList.remove("show"),setTimeout(()=>{u.remove()},150)})}))}},xe={class:"modal fade",id:"qrCodeModal",tabindex:"-1","aria-labelledby":"qrCodeModalLabel",role:"dialog"},Le={class:"modal-dialog modal-dialog-centered"},Me={class:"modal-content"},qe={class:"modal-header theme-header"},Oe={class:"modal-title",id:"qrCodeModalLabel"},Se={class:"modal-body text-center"},Re={key:0,class:"my-3"},Pe={key:1},Qe={class:"mb-3"},Fe=["src"],Ae={key:1,class:"text-danger"},Be={class:"mb-3"},Ee={key:0,class:"mb-1"},Ue={key:1,class:"mt-2"},Te={class:"modal-footer"};function Ne(a,t,c,o,u,y){const p=R("LoadingSpinner");return d(),i("div",xe,[e("div",Le,[e("div",Me,[e("div",qe,[e("h5",Oe,m(u.qrCodeTitle||"QR Code"),1),t[2]||(t[2]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",Se,[u.qrCodeLoading?(d(),i("div",Re,[k(p,{message:"Generating QR code..."})])):(d(),i("div",Pe,[e("div",Qe,[u.qrCodeUrl?(d(),i("img",{key:0,src:u.qrCodeUrl,alt:"QR Code",class:"img-fluid secure-qr",style:{"max-width":"250px"},onContextmenu:t[0]||(t[0]=_e(()=>{},["prevent"]))},null,40,Fe)):(d(),i("p",Ae,"Failed to generate QR code."))]),e("div",Be,[u.selectedLocationID?(d(),i("p",Ee,[t[3]||(t[3]=e("strong",null,"Location ID:",-1)),J(" "+m(u.selectedLocationID),1)])):g("",!0),u.qrCodeDescription?(d(),i("p",Ue,m(u.qrCodeDescription),1)):g("",!0)])]))]),e("div",Te,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=(...b)=>y.closeQRModal&&y.closeQRModal(...b))},"Back")])])])])}const je=$(Ie,[["render",Ne],["__scopeId","data-v-d52771aa"]]),Ve={name:"OrderManagement",components:{StatsCard:we,ResponsiveTable:ke,LoadingSpinner:ee,OrderDetailModal:je,Pagination:De},setup(){const a=be(),t=f(!0),c=f(null),o=f([]),u=f({total_orders:0,pending_orders:0,completed_orders:0,processing_orders:0,waiting_orders:0}),y=f({}),p=f({}),b=f(null),L=f(null),q=f(null),r=f({}),Q=f(""),l=f(""),D=ye({from:"",to:""});f("created_at"),f("desc"),f(10);const _=f({}),O=f({}),H=f(1),F=f({current_page:1,last_page:1,per_page:10,total:0,from:1,to:10}),te=G(()=>{const s=[];if(F.value.last_page<=7)for(let n=1;n<=F.value.last_page;n++)s.push(n);else{let n=Math.max(1,H.value-2),h=Math.min(F.value.last_page,n+4);h-n<4&&(n=Math.max(1,h-4));for(let x=n;x<=h;x++)s.push(x)}return s}),oe=s=>P.formatLargeNumber(s),se=s=>P.formatCurrency(s),ae=s=>P.formatDate(s),re=s=>s?s.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "):"Unknown",ne=s=>s&&{pending:"warning",processing:"info",complete:"success",waiting_verification:"primary",waiting_delivery:"primary",paid:"dark"}[s.toLowerCase()]||"secondary",le=s=>{r.value={...r.value,[s]:!r.value[s]}},ie=async(s,n)=>{try{q.value&&(b.value=null,L.value=null,q.value.showQRCode(null,s,n))}catch{}},de=async s=>{try{const n=await Z.get(`/api/generate-signed-url/awb/${s}`);window.open(n.url,"_blank")}catch(n){console.error("Error generating signed URL:",n)}};let K=null;const ce=()=>{clearTimeout(K),K=setTimeout(()=>{N()},500)},U=async()=>{try{const s={search:Q.value,date_from:D.from,date_to:D.to},n=await E.fetchLocationsByCompanyType(s);n.success&&(o.value=n.data.map(h=>({...h,orders:[],pagination:{total:h.order_count,per_page:10,current_page:1,last_page:Math.ceil(h.order_count/10),from:0,to:0}})),n.filtered_location_type)}catch{c.value="Failed to load locations"}},M=async(s,n=null)=>{try{y.value[s]=!0;const h=n||_.value[s]||1,x={page:h,per_page:10,status:l.value,date_from:D.from,date_to:D.to},C=await E.fetchOrdersByLocationID(s,x);if(C.success){const v=o.value.findIndex(I=>I.locationID===s);if(v!==-1){o.value[v].orders=C.data.orders;const I={...C.data.pagination,current_page:parseInt(C.data.pagination.current_page)};o.value[v].pagination=I,O.value[s]=I,_.value[s]=h}}}catch{c.value="Failed to load orders for location"}finally{y.value[s]=!1}},me=s=>{p.value[s]&&clearInterval(p.value[s]),p.value[s]=setInterval(()=>{y.value[s]||M(s)},2e4)},X=async()=>{try{const s=await E.fetchOrderStats();s&&typeof s=="object"&&(u.value={total_orders:s.total_orders||0,waiting_for_delivery_orders:s.waiting_for_delivery_orders||0,in_progress_orders:s.in_progress_orders||0,complete_orders:s.complete_orders||0})}catch{}},ue=G(()=>{const s=a.getters.user;return s&&s.company?s.company.company_type==="broiler":!1}),T=G(()=>{const s=a.getters.user;return s&&s.company?s.company.company_type==="sme":!1}),N=async()=>{await U(),o.value.length>0&&await Promise.all(o.value.map(s=>M(s.locationID,1)))},ge=(s,n)=>{const h=O.value[s];!h||n<1||n>h.last_page||(_.value[s]=parseInt(n),M(s,parseInt(n)))},he=s=>{const n=O.value[s];if(!n)return[];const h=[],x=n.current_page,C=5;if(n.last_page<=C)for(let v=1;v<=n.last_page;v++)h.push(v);else{let v=Math.max(1,x-Math.floor(C/2)),I=Math.min(n.last_page,v+C-1);I===n.last_page&&(v=Math.max(1,I-C+1));for(let V=v;V<=I;V++)h.push(V)}return h},fe=async()=>{t.value=!0,c.value=null;try{await U(),o.value.length>0&&await Promise.all(o.value.map(s=>M(s.locationID,1))),T.value&&await X()}catch{c.value="Failed to refresh data"}finally{t.value=!1,j()}},j=()=>{Y(),o.value&&o.value.length>0&&o.value.forEach(s=>{me(s.locationID)})},Y=()=>{Object.keys(p.value).forEach(s=>{p.value[s]&&(clearInterval(p.value[s]),delete p.value[s])})},pe=()=>{Q.value="",l.value="",D.from="",D.to="",N()};return Ce(async()=>{if(t.value=!0,await U(),o.value&&o.value.length>0){const s=o.value.map(n=>M(n.locationID));await Promise.all(s)}T.value&&await X(),t.value=!1,j()}),{loading:t,error:c,locations:o,orderStats:u,expandedOrders:r,searchQuery:Q,statusFilter:l,dateRangeFilter:D,currentPage:H,getAllOrderItems:We,pagination:F,paginationRange:te,locationPages:_,locationPaginations:O,locationLoading:y,refreshIntervals:p,getPaginationRange:he,formatLargeNumber:oe,formatCurrency:se,formatDate:ae,formatStatus:re,getStatusColor:ne,toggleOrder:le,generateLocationQR:ie,generateOrderQR:de,generateInvoice:async s=>{try{const n=await Z.get(`/api/generate-signed-url/invoice/${s}`);window.open(n.url,"_blank")}catch(n){console.error("Error generating signed URL:",n)}},debounceSearch:ce,applyFilters:N,changePage:ge,refreshData:fe,resetFilters:pe,selectedOrderId:b,selectedOrder:L,orderDetailModalRef:q,isBroilerCompany:ue,isSMECompany:T,startAutoRefresh:j,stopAutoRefresh:Y,loadLocationOrders:M}}},We=a=>{if(!a)return[];if(a.items&&Array.isArray(a.items))return a.items;if(a.checkpoints){const t=[];for(const c of a.checkpoints)c.items&&c.items.length&&t.push(...c.items);return t}return[]},ze={class:"order-management"},Ge={key:0,class:"row mb-4"},Je={class:"col-md-3 col-sm-6 mb-3"},He={class:"col-md-3 col-sm-6 mb-3"},Ke={class:"col-md-3 col-sm-6 mb-3"},Xe={class:"col-md-3 col-sm-6 mb-3"},Ye={class:"card theme-card"},Ze={class:"card-header d-flex justify-content-between align-items-center theme-header"},$e={class:"card-body theme-body"},et={key:0,class:"alert alert-danger",role:"alert"},tt={class:"mb-4"},ot={class:"row g-2"},st={class:"col-12 col-md-6 col-lg-4"},at={class:"input-group"},rt={class:"col-12 col-md-6 col-lg-2"},nt={class:"col-12 col-sm-6 col-lg-3"},lt={class:"input-group"},it={class:"col-12 col-sm-6 col-lg-3"},dt={class:"input-group"},ct={class:"d-flex justify-content-end mt-2"},mt={key:1,class:"text-center py-5"},ut={key:2,class:"text-center py-5"},gt={key:3},ht={class:"card theme-inner-card"},ft={class:"card-header theme-card-header"},pt={class:"d-flex flex-column flex-md-row justify-content-between align-items-md-center"},_t={class:"mb-2 mb-md-0"},vt={class:"badge theme-badge-location me-2"},yt={class:"d-flex justify-content-between align-items-center"},bt={class:"badge theme-badge-primary me-3"},Ct=["onClick"],wt={class:"card-body p-0"},kt={class:"table-responsive position-relative"},Dt={key:0,class:"table-overlay"},It={class:"table table-hover mb-0 theme-table"},xt={class:"theme-table-header d-none d-md-table-header-group"},Lt={key:0,scope:"col"},Mt={key:1,scope:"col"},qt={class:"text-center"},Ot=["onClick","aria-expanded"],St={class:"d-none d-md-table-cell"},Rt={class:"d-none d-md-table-cell"},Pt={class:"d-none d-md-table-cell"},Qt={key:0,class:"d-none d-md-table-cell"},Ft={key:1,class:"d-none d-md-table-cell text-center"},At=["onClick"],Bt={class:"d-md-none",colspan:"5"},Et={class:"d-flex justify-content-between align-items-start mb-1"},Ut={class:"mb-1"},Tt={key:0,class:"text-muted small mb-1"},Nt={key:1,class:"mt-2"},jt=["onClick"],Vt={key:0},Wt={colspan:"6",class:"p-0"},zt={class:"p-3 theme-details"},Gt={class:"table-responsive"},Jt={class:"table table-sm table-bordered theme-inner-table"},Ht={class:"theme-table-header"},Kt={key:0,style:{width:"auto","white-space":"nowrap"},class:"text-center"},Xt={class:"d-flex align-items-center"},Yt={class:"fw-bold"},Zt={class:"text-muted"},$t={key:0,class:"text-center"},eo=["onClick"],to={key:0,class:"d-flex flex-column flex-md-row justify-content-between align-items-center p-3 border-top theme-pagination-container"},oo={class:"mb-2 mb-md-0"},so={key:0,class:"theme-pagination-text"},ao={key:0};function ro(a,t,c,o,u,y){const p=R("StatsCard"),b=R("LoadingSpinner"),L=R("Pagination"),q=R("OrderDetailModal");return d(),i("div",ze,[t[31]||(t[31]=e("h1",{class:"mb-4"},"Order Management",-1)),o.isSMECompany?(d(),i("div",Ge,[e("div",Je,[k(p,{title:"Total Orders",count:o.formatLargeNumber(o.orderStats.total_orders),icon:"fas fa-shopping-cart","bg-color":"bg-primary"},null,8,["count"])]),e("div",He,[k(p,{title:"Waiting For Delivery",count:o.formatLargeNumber(o.orderStats.waiting_for_delivery_orders),icon:"fas fa-hourglass-half","bg-color":"bg-warning"},null,8,["count"])]),e("div",Ke,[k(p,{title:"In Progress",count:o.formatLargeNumber(o.orderStats.in_progress_orders),icon:"fas fa-cogs","bg-color":"bg-info"},null,8,["count"])]),e("div",Xe,[k(p,{title:"Complete",count:o.formatLargeNumber(o.orderStats.complete_orders),icon:"fas fa-check-circle","bg-color":"bg-success"},null,8,["count"])])])):g("",!0),e("div",Ye,[e("div",Ze,[t[11]||(t[11]=e("h5",{class:"mb-0"},"Orders by Location",-1)),e("button",{class:"btn btn-sm theme-btn-outline",onClick:t[0]||(t[0]=(...r)=>o.refreshData&&o.refreshData(...r))},t[10]||(t[10]=[e("i",{class:"fas fa-sync-alt"},null,-1),J(" Refresh ")]))]),e("div",$e,[o.error?(d(),i("div",et,m(o.error),1)):g("",!0),e("div",tt,[e("div",ot,[e("div",st,[e("div",at,[A(e("input",{type:"text",class:"form-control",placeholder:"Search orders...","onUpdate:modelValue":t[1]||(t[1]=r=>o.searchQuery=r),onInput:t[2]||(t[2]=(...r)=>o.debounceSearch&&o.debounceSearch(...r))},null,544),[[W,o.searchQuery]]),t[12]||(t[12]=e("button",{class:"btn btn-outline-secondary",type:"button"},[e("i",{class:"fas fa-search"})],-1))])]),e("div",rt,[A(e("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=r=>o.statusFilter=r),onChange:t[4]||(t[4]=(...r)=>o.applyFilters&&o.applyFilters(...r))},t[13]||(t[13]=[e("option",{value:""},"All Statuses",-1),e("option",{value:"waiting_for_delivery"},"Waiting for Delivery",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"complete"},"Complete",-1)]),544),[[ve,o.statusFilter]])]),e("div",nt,[e("div",lt,[t[14]||(t[14]=e("span",{class:"input-group-text"},"From",-1)),A(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=r=>o.dateRangeFilter.from=r),onChange:t[6]||(t[6]=(...r)=>o.applyFilters&&o.applyFilters(...r))},null,544),[[W,o.dateRangeFilter.from]])])]),e("div",it,[e("div",dt,[t[15]||(t[15]=e("span",{class:"input-group-text"},"To",-1)),A(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=r=>o.dateRangeFilter.to=r),onChange:t[8]||(t[8]=(...r)=>o.applyFilters&&o.applyFilters(...r))},null,544),[[W,o.dateRangeFilter.to]])])])]),e("div",ct,[e("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[9]||(t[9]=(...r)=>o.resetFilters&&o.resetFilters(...r))},t[16]||(t[16]=[e("i",{class:"fas fa-times"},null,-1),J(" Clear Filters ")]))])]),o.loading?(d(),i("div",mt,[k(b)])):g("",!0),!o.loading&&(!o.locations||o.locations.length===0)?(d(),i("div",ut,t[17]||(t[17]=[e("div",{class:"mb-3"},[e("i",{class:"fas fa-box-open fa-4x text-muted"})],-1),e("h5",{class:"text-muted"},"No orders found",-1),e("p",{class:"text-muted"},"Try adjusting your filters or check back later.",-1)]))):g("",!0),!o.loading&&o.locations&&o.locations.length>0?(d(),i("div",gt,[(d(!0),i(B,null,z(o.locations,(r,Q)=>(d(),i("div",{key:r.locationID,class:"location-card mb-4"},[e("div",ht,[e("div",ft,[e("div",pt,[e("div",_t,[e("span",vt,m(r.location_type),1),e("strong",null,m(r.company_address),1)]),e("div",yt,[e("span",bt,m(r.orders.length)+" orders",1),e("button",{class:"btn btn-sm btn-primary",onClick:l=>o.generateLocationQR(r.locationID,r.companyID||0),title:"Generate QR Code for this location"},t[18]||(t[18]=[e("i",{class:"fas fa-qrcode"},null,-1)]),8,Ct)])])]),e("div",wt,[e("div",kt,[o.locationLoading[r.locationID]?(d(),i("div",Dt,[k(b,{overlay:"",message:"Loading orders..."})])):g("",!0),e("table",It,[e("thead",xt,[e("tr",null,[t[19]||(t[19]=e("th",{scope:"col",style:{width:"50px"}},null,-1)),t[20]||(t[20]=e("th",{scope:"col"},"Order ID",-1)),t[21]||(t[21]=e("th",{scope:"col"},"Status",-1)),t[22]||(t[22]=e("th",{scope:"col"},"Date",-1)),o.isBroilerCompany?(d(),i("th",Lt,"Customer")):g("",!0),o.isSMECompany?(d(),i("th",Mt,"Invoice")):g("",!0)])]),e("tbody",null,[(d(!0),i(B,null,z(r.orders,(l,D)=>(d(),i(B,{key:l.orderID},[e("tr",{class:S(["theme-list-item",{"theme-list-item-active":o.expandedOrders[l.orderID]}])},[e("td",qt,[e("button",{class:"btn btn-sm btn-link p-0",onClick:_=>o.toggleOrder(l.orderID),"aria-expanded":o.expandedOrders[l.orderID]?"true":"false"},[e("i",{class:S(["fas theme-icon",o.expandedOrders[l.orderID]?"fa-chevron-down":"fa-chevron-right"])},null,2)],8,Ot)]),e("td",St,[e("strong",null,"#"+m(l.orderID),1)]),e("td",Rt,[e("span",{class:S(["badge",`theme-badge-${o.getStatusColor(l.calculated_status||l.order_status)}`])},m(o.formatStatus(l.calculated_status||l.order_status)),3)]),e("td",Pt,m(o.formatDate(l.created_at)),1),o.isBroilerCompany?(d(),i("td",Qt,m(l.user?l.user.fullname||l.user.email:"N/A"),1)):g("",!0),o.isSMECompany?(d(),i("td",Ft,[e("button",{class:"btn btn-sm btn-outline-primary",onClick:_=>o.generateInvoice(l.orderID),title:"Download Invoice"},t[23]||(t[23]=[e("i",{class:"fas fa-file-invoice"},null,-1),e("span",{class:"d-none d-sm-inline ms-1"},"Invoice",-1)]),8,At)])):g("",!0),e("td",Bt,[e("div",Et,[e("strong",null,"#"+m(l.orderID),1),e("span",null,m(o.formatDate(l.created_at)),1)]),e("div",Ut,[e("span",{class:S(["badge",`theme-badge-${o.getStatusColor(l.calculated_status||l.order_status)}`])},m(o.formatStatus(l.calculated_status||l.order_status)),3)]),o.isBroilerCompany?(d(),i("div",Tt,m(l.user?l.user.fullname||l.user.email:"N/A"),1)):g("",!0),o.isSMECompany?(d(),i("div",Nt,[e("button",{class:"btn btn-sm btn-outline-primary",onClick:_=>o.generateInvoice(l.orderID),title:"Download Invoice"},t[24]||(t[24]=[e("i",{class:"fas fa-file-invoice"},null,-1),e("span",{class:"ms-1"},"Invoice",-1)]),8,jt)])):g("",!0)])],2),o.expandedOrders[l.orderID]?(d(),i("tr",Vt,[e("td",Wt,[e("div",zt,[t[30]||(t[30]=e("h6",{class:"mb-3 theme-subtitle"},"Order Items",-1)),e("div",Gt,[e("table",Jt,[e("thead",Ht,[e("tr",null,[t[26]||(t[26]=e("th",{style:{width:"auto","white-space":"nowrap"}},"Cart ID",-1)),t[27]||(t[27]=e("th",null,"Item",-1)),t[28]||(t[28]=e("th",{style:{width:"auto","white-space":"nowrap"}},"Quantity",-1)),o.isBroilerCompany?(d(),i("th",Kt,t[25]||(t[25]=[e("span",{class:"d-none d-sm-inline"},"AWB Download",-1),e("span",{class:"d-inline d-sm-none"},"AWB",-1)]))):g("",!0)])]),e("tbody",null,[(d(!0),i(B,null,z(o.getAllOrderItems(l),_=>(d(),i("tr",{key:`${l.orderID}-${_.cartID}-${_.itemID}`},[e("td",null,m(_.cartID),1),e("td",null,[e("div",Xt,[e("div",null,[e("div",Yt,m(_.item_name),1),e("small",Zt,m(_.measurement_value)+" "+m(_.measurement_type),1)])])]),e("td",null,m(_.quantity),1),o.isBroilerCompany?(d(),i("td",$t,[e("button",{class:"btn btn-sm btn-outline-primary",onClick:O=>o.generateOrderQR(l.orderID),title:"Download AWB Waybill"},t[29]||(t[29]=[e("i",{class:"fas fa-file-download"},null,-1),e("span",{class:"d-inline d-sm-none ms-1"},"AWB",-1)]),8,eo)])):g("",!0)]))),128))])])])])])])):g("",!0)],64))),128))])])])])]),!o.loading&&r.orders&&r.orders.length>0?(d(),i("div",to,[e("div",oo,[o.locationPaginations[r.locationID]?(d(),i("span",so," Showing "+m(o.locationPaginations[r.locationID].from||1)+"-"+m(o.locationPaginations[r.locationID].to||r.orders.length)+" of "+m(o.locationPaginations[r.locationID].total||r.orders.length),1)):g("",!0)]),o.locationPaginations[r.locationID]&&o.locationPaginations[r.locationID].last_page>1?(d(),i("div",ao,[k(L,{pagination:o.locationPaginations[r.locationID],"max-visible-pages":5,onPageChanged:l=>o.changePage(r.locationID,l),class:S({"pagination-loading":o.locationLoading[r.locationID]})},null,8,["pagination","onPageChanged","class"])])):g("",!0)])):g("",!0)]))),128))])):g("",!0)])]),k(q,{ref:"orderDetailModalRef","order-id":o.selectedOrderId,"order-data":o.selectedOrder,"modal-id":"orderPageDetailModal","show-main-modal-after-QR":!1},null,8,["order-id","order-data"])])}const ho=$(Ve,[["render",ro],["__scopeId","data-v-eb86b910"]]);export{ho as default};
