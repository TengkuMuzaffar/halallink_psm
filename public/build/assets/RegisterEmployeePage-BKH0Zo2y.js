import{_ as L,C as q,r as c,c as s,a,w as v,v as h,b as g,t as f,e as w,d as x,o as t,f as C,g as F,s as N,F as U,j as E,y as S,D as T,u as V,E as M}from"./main-BpaYbEPg.js";import{L as B}from"./LoginLeftPanel-B-QNyV8a.js";import{a as j}from"./authService-XNlR-tBG.js";const A={name:"RegisterFormEmployee",props:{loading:{type:Boolean,default:!1},error:{type:[String,Object],default:null},formId:{type:String,required:!0}},emits:["submit","login"],setup(p,{emit:o}){const n=q({fullname:"",email:"",tel_number:"",password:"",password_confirmation:""}),e=c(null),u=c(""),d=c("");return{formData:n,imageFile:e,imageFileName:u,imagePreview:d,handleFileUpload:i=>{const l=i.target.files[0];if(l){e.value=l,u.value=l.name;const D=new FileReader;D.onload=R=>{d.value=R.target.result},D.readAsDataURL(l)}},handleSubmit:()=>{const i=new FormData;Object.keys(n).forEach(l=>{i.append(l,n[l])}),e.value&&i.append("image",e.value),o("submit",i)}}}},J={class:"form-group"},O={class:"form-group"},Y={class:"form-group"},H={class:"form-group"},z={class:"form-group"},G={class:"form-group file-upload"},K={for:"employee_image",class:"file-label"},Q={key:0,class:"logo-preview"},W=["src"],X=["disabled"],Z={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},$={class:"text-center mt-3"};function ee(p,o,n,e,u,d){return t(),s("form",{onSubmit:o[7]||(o[7]=x((...r)=>e.handleSubmit&&e.handleSubmit(...r),["prevent"])),class:"login-form",enctype:"multipart/form-data"},[a("div",J,[v(a("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=r=>e.formData.fullname=r),placeholder:"Full Name",required:""},null,512),[[h,e.formData.fullname]])]),a("div",O,[v(a("input",{type:"email","onUpdate:modelValue":o[1]||(o[1]=r=>e.formData.email=r),placeholder:"Email",required:""},null,512),[[h,e.formData.email]])]),a("div",Y,[v(a("input",{type:"tel","onUpdate:modelValue":o[2]||(o[2]=r=>e.formData.tel_number=r),placeholder:"Phone Number",required:""},null,512),[[h,e.formData.tel_number]])]),a("div",H,[v(a("input",{type:"password","onUpdate:modelValue":o[3]||(o[3]=r=>e.formData.password=r),placeholder:"Password",required:""},null,512),[[h,e.formData.password]])]),a("div",z,[v(a("input",{type:"password","onUpdate:modelValue":o[4]||(o[4]=r=>e.formData.password_confirmation=r),placeholder:"Confirm Password",required:""},null,512),[[h,e.formData.password_confirmation]])]),a("div",G,[a("label",K,[a("span",null,f(e.imageFileName||"Upload Profile Picture (Optional)"),1),a("input",{type:"file",id:"employee_image",onChange:o[5]||(o[5]=(...r)=>e.handleFileUpload&&e.handleFileUpload(...r)),accept:"image/*",class:"file-input"},null,32)]),e.imagePreview?(t(),s("div",Q,[a("img",{src:e.imagePreview,alt:"Profile Picture Preview"},null,8,W)])):g("",!0)]),a("button",{type:"submit",class:"btn btn-primary w-100",disabled:n.loading},[n.loading?(t(),s("span",Z)):g("",!0),w(" "+f(n.loading?"Registering...":"Register"),1)],8,X),a("div",$,[o[8]||(o[8]=w(" Already have an account? ")),a("a",{href:"#",onClick:o[6]||(o[6]=x(r=>p.$emit("login"),["prevent"]))},"Login")])],32)}const oe=L(A,[["render",ee],["__scopeId","data-v-ec7a1808"]]),ae={name:"RegisterEmployeePage",components:{LoginLeftPanel:B,RegisterFormEmployee:oe},setup(){const p=V(),o=T(),n=c(!1),e=c(null),u=c(null),d=c(""),r=c(""),_=c(""),i=["Join your company team","Connect with your colleagues","Access company resources","Be part of the Halal ecosystem"],l=async b=>{try{n.value=!0;const m=await M.get(`/api/companies/form/${b}`);m.data&&(r.value=m.data.company_name,m.data.company_image&&(_.value=m.data.company_image)),n.value=!1}catch(m){console.error("Error fetching company info:",m),m.value="Could not retrieve company information. Please check the registration link.",n.value=!1}};return S(()=>{console.log("Route query:",o.query),o.query.formID?(console.log("FormID found:",o.query.formID),d.value=o.query.formID,l(d.value)):(console.error("No formID in query params"),e.value="Company ID is required. Please contact your administrator.",setTimeout(()=>{p.push({name:"Login"})},3e3))}),{loading:n,error:e,successMessage:u,animatedTexts:i,formID:d,companyName:r,companyImage:_,handleRegister:async b=>{var m,k,I,P;n.value=!0,e.value=null,u.value=null;try{b.append("formID",d.value);const y=await j(b);u.value=y.message||"Registration successful! Your account is pending approval. Redirecting to login page...",setTimeout(()=>{p.push({name:"Login"})},3e3)}catch(y){console.error("Registration error:",y),(k=(m=y.response)==null?void 0:m.data)!=null&&k.errors?e.value=y.response.data.errors:e.value=((P=(I=y.response)==null?void 0:I.data)==null?void 0:P.message)||"Registration failed. Please try again."}finally{n.value=!1}},goToLogin:()=>{p.push({name:"Login"})}}}},re={class:"login-container"},ne={class:"login-card"},te={class:"right-panel"},se={key:0,class:"company-info mb-4"},le={key:0,class:"company-image mb-3"},ie=["src"],me={key:1},de={key:2,class:"alert alert-success w-100 mb-4"},ce={key:3,class:"alert alert-danger w-100 mb-4"},ue={key:0},pe={key:1,class:"mb-0 ps-3"};function ge(p,o,n,e,u,d){const r=F("login-left-panel"),_=F("register-form-employee");return t(),s("div",re,[a("div",ne,[C(r,{texts:e.animatedTexts},null,8,["texts"]),a("div",te,[e.companyName?(t(),s("div",se,[e.companyImage?(t(),s("div",le,[a("img",{src:e.companyImage,alt:"Company Logo",class:"img-fluid rounded",style:{"max-height":"80px"}},null,8,ie)])):g("",!0),a("h2",null,"Join "+f(e.companyName),1),o[0]||(o[0]=a("p",null,"Register as an employee",-1))])):(t(),s("div",me,o[1]||(o[1]=[a("h2",null,"Join Your Company",-1),a("p",null,"Register as an employee",-1)]))),e.successMessage?(t(),s("div",de,[o[2]||(o[2]=a("i",{class:"fas fa-check-circle me-2"},null,-1)),w(" "+f(e.successMessage),1)])):g("",!0),e.error?(t(),s("div",ce,[o[3]||(o[3]=a("i",{class:"fas fa-exclamation-circle me-2"},null,-1)),typeof e.error=="string"?(t(),s("span",ue,f(e.error),1)):typeof e.error=="object"?(t(),s("ul",pe,[(t(!0),s(U,null,E(e.error,(i,l)=>(t(),s("li",{key:l},[a("strong",null,f(l)+":",1),w(" "+f(Array.isArray(i)?i.join(", "):i),1)]))),128))])):g("",!0)])):g("",!0),e.successMessage?g("",!0):(t(),N(_,{key:4,loading:e.loading,error:null,formId:e.formID,onSubmit:e.handleRegister,onLogin:e.goToLogin},null,8,["loading","formId","onSubmit","onLogin"]))])])])}const ve=L(ae,[["render",ge],["__scopeId","data-v-d8228778"]]);export{ve as default};
